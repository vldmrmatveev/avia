(()=>{"use strict";var e,t={5146:(e,t,n)=>{var r=n(151),a=n.n(r);function i(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){i(o,r,a,c,u,"next",e)}function u(e){i(o,r,a,c,u,"throw",e)}c(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t}var t,n,r,a,i;return t=e,(n=[{key:"cities",value:(i=o(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.url,"/cities"));case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return i.apply(this,arguments)})},{key:"prices",value:(a=o(regeneratorRuntime.mark((function e(t){var n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in e.prev=0,n=new URL("".concat(this.url,"/prices/cheap")),t)n.searchParams.set(r,t[r]);return e.next=5,fetch(n);case 5:return a=e.sent,e.next=8,a.json();case 8:return i=e.sent,e.abrupt("return",i);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return a.apply(this,arguments)})}])&&c(t.prototype,n),r&&c(t,r),e}())("https://aviasales-api.herokuapp.com");function s(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,c,"next",e)}function c(e){s(i,r,a,o,c,"throw",e)}o(void 0)}))}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t,this.cities=null,this.lastSearch={}}var t,n,r,a,i;return t=e,(n=[{key:"fetchTickets",value:(i=l(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.prices(t);case 2:return n=e.sent,this.lastSearch=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"init",value:(a=l(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.cities();case 2:return t=e.sent,this.cities=this.createCitiesName(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"createCitiesName",value:function(e){return e.map((function(e){return"".concat(e.name,", ").concat(e.code)}))}}])&&m(t.prototype,n),r&&m(t,r),e}())(u);function d(e){Object.values(e).forEach((function(e){!function(e){var t=document.createDocumentFragment(),n=document.createElement("div");n.classList.add("card-item");var r=document.createElement("img");r.classList.add("card-item-img"),r.setAttribute("src","https://pics.avs.io/200/200/".concat(e.airline,".png"));var a=document.createElement("h3");a.classList.add("card-item-title");var i=document.createElement("span");i.textContent=e.origin;var o=document.createElement("span");o.textContent=e.destination;var c=document.createElement("span"),u=document.createElement("p"),s=document.createElement("p"),l=document.createElement("span");l.textContent="Отправление: ";var m=document.createElement("span");m.classList.add("card-item-time"),m.textContent=p(e.departure_at),s.append(l,m);var f=document.createElement("p"),d=document.createElement("span");d.textContent="Прибытие: ";var v=document.createElement("span");v.classList.add("card-item-time"),v.textContent=p(e.return_at),f.append(d,v),u.classList.add("card-item-price"),u.textContent="".concat(e.price," ₽"),c.textContent=" - ",a.append(i,c,o),n.append(r,a,s,f,u),t.append(n),document.querySelector(".card-container").append(t)}(e)}))}function p(e){var t=new Date(e),n=new Intl.DateTimeFormat("ru",{month:"long",day:"numeric"}),r=new Intl.DateTimeFormat("ru",{hour:"numeric",minute:"numeric"});return n.format(t)+" в "+r.format(t)}function v(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=f.init().then((function(){return f.cities}));function g(e,t){return{selector:e,placeHolder:t,data:{src:y,cache:!0},resultItem:{highlight:!0},resultsList:{element:function(e,t){if(!t.results.length){var n=document.createElement("div");n.setAttribute("class","no_result"),n.innerHTML='<span>Ничего не найдено "'.concat(t.query,'"</span>'),e.appendChild(n)}},noResults:!0},events:{input:{selection:function(t){var n=t.detail.selection.value;document.querySelector(e).value=n}}}}}function w(e){var t,n,r,a;e.setAttribute("min",(t=new Date,n=t.getFullYear(),r=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getDate(),n+"-"+r+"-"+a))}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=document.forms[t],this.dateFrom=this.form.elements["from-date"],this.dateTo=this.form.elements["to-date"],this.fromCity=this.form.elements.from,this.toCity=this.form.elements.to}var t,n,r,a,i;return t=e,(n=[{key:"dateFromValue",get:function(){return this.dateFrom.value}},{key:"dateToValue",get:function(){return this.dateTo.value}},{key:"fromCityValue",get:function(){return this.fromCity.value.split(", ")[1].trim()}},{key:"toCityValue",get:function(){return this.toCity.value.split(", ")[1].trim()}},{key:"formSubmit",value:(a=regeneratorRuntime.mark((function e(){var t,n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.fromCityValue,n=this.toCityValue,r=this.dateFromValue,a=this.dateToValue,i={origin:t,destination:n,depart_date:r,return_date:a,currency:"RUB"},e.next=8,f.fetchTickets(i);case 8:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=a.apply(e,t);function o(e){v(i,n,r,o,c,"next",e)}function c(e){v(i,n,r,o,c,"throw",e)}o(void 0)}))},function(){return i.apply(this,arguments)})}])&&h(t.prototype,n),r&&h(t,r),e}();function x(){new(a())(g("[name='from']","Откуда...")),new(a())(g("[name='to']","Куда..."));var e=new b("searchTickets");w(e.dateFrom),e.dateFrom.addEventListener("change",(function(){var t,n,r;e.dateTo.disabled=!1,e.dateTo.setAttribute("min",this.value),t=e.dateFrom,n=e.dateTo,r=new Date(t.value),+new Date(n.value)<+r&&(n.value="")})),e.form.addEventListener("submit",(function(t){t.preventDefault(),document.querySelector(".card-container").innerHTML="",e.formSubmit().then((function(){d(f.lastSearch.data)}))}))}document.addEventListener("DOMContentLoaded",(function(){x()}))},2797:()=>{}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,a,i)=>{if(!n){var o=1/0;for(l=0;l<e.length;l++){for(var[n,a,i]=e[l],c=!0,u=0;u<n.length;u++)(!1&i||o>=i)&&Object.keys(r.O).every((e=>r.O[e](n[u])))?n.splice(u--,1):(c=!1,i<o&&(o=i));if(c){e.splice(l--,1);var s=a();void 0!==s&&(t=s)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,a,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[o,c,u]=n,s=0;for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(u)var l=u(r);for(t&&t(n);s<o.length;s++)i=o[s],r.o(e,i)&&e[i]&&e[i][0](),e[o[s]]=0;return r.O(l)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.O(void 0,[506],(()=>r(1202))),r.O(void 0,[506],(()=>r(5146)));var a=r.O(void 0,[506],(()=>r(2797)));a=r.O(a)})();